{"componentChunkName":"component---src-templates-blog-post-js","path":"/posts/simple-polling-with-js/","result":{"data":{"markdownRemark":{"html":"<p>So, as a relatively new Javascript programmer, recently I had to implement some basic polling\nfunctionality inside a web application. Doing a bit of research, it was revealed to me that there are\nsome <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API\">clever</a> <a href=\"https://stackoverflow.com/questions/1086380/how-does-facebook-gmail-send-the-real-time-notification/1086448#1086448\">ways</a> to handle something like this but, since I just needed to get something\nquick and dirty working, this small snippet of JS did the job just fine:</p>\n<iframe\n  src=\"https://carbon.now.sh/embed/rFI4GvotGROd9VcW09Sr\"\n  style=\"transform:scale(1); width:100%; height:541px; border:0; overflow:hidden;\"\n  sandbox=\"allow-scripts allow-same-origin\">\n</iframe>\n<p>However, and despite only being a couple of lines of JavaScript, I found it quite interesting. There a lot of not-so-simple things about these few lines of code. Let's review step-by-step how it works:</p>\n<ul>\n<li>First off, your program should call <code>startPolling()</code> whenever it needs to, well, start polling.</li>\n<li>This, in turn, starts off by wrapping a <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise\">Promise</a> around a function.</li>\n<li>This function recursively polls for something until a condition is reached.</li>\n<li>When the condition is met, the Promise is resolved, and the code inside <code>then()</code> is executed.</li>\n</ul>\n<p>Now, let's try implementing this on a simple example.</p>\n<p>Normally, you'd be sending request to a server and receiving periodic updates. We'll try to emulate this by making calls to the <a href=\"https://randomuser.me/\">Random User API</a> until we get a user from a certain country (let's say Germany). To do this, we can make requests using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\">fetch</a>, like this:</p>\n<iframe\n  src=\"https://carbon.now.sh/embed/bmCSqN8F6fvPRipvbMqw\"\n  style=\"transform:scale(1); width:100%; height:643px; border:0; overflow:hidden;\"\n  sandbox=\"allow-scripts allow-same-origin\">\n</iframe>\n<p>As you can see, JavaScript's Fetch API makes heavy use of Promises as well: <code>fetch()</code> returns a Promise which, when resolved, returns yet another Promise, and only then can we get our data. It's Promises all the way down!<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>.</p>\n<p>Running this code inside a browser, we can see the ouput in the console:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 533px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c3c742100dadf8864ea78babbaf78a08/a1aa0/console_example.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAApklEQVQoz5VRyw6DMAzr//8mjLY06YMBWtlSZhjamVhplB4sx46p2xaIAjExo28amNaaHwOKY1rWddfAiEjOxTqPjn/T4CBzjCCnnJsSx9pw2/XDsqyYdWuDwJwG557zvCtxBTYGstYjM9GIH2RcCPwQqNaqU8YD0/lRa/g6FZ3KuZQ/X5E21u76RykTZjlxV/kjElMarC/T9DOP2G6Km9e7idrshS8BTv4VVzGezwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Hopper The Rabbit\"\n        title=\"Hopper The Rabbit\"\n        src=\"/static/c3c742100dadf8864ea78babbaf78a08/a1aa0/console_example.png\"\n        srcset=\"/static/c3c742100dadf8864ea78babbaf78a08/772e8/console_example.png 200w,\n/static/c3c742100dadf8864ea78babbaf78a08/e17e5/console_example.png 400w,\n/static/c3c742100dadf8864ea78babbaf78a08/a1aa0/console_example.png 533w\"\n        sizes=\"(max-width: 533px) 100vw, 533px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Success! </p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>You could refactor this to use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\">async/await</a> syntax to make it a bit more sane.</p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">â†©</a>\n</li>\n</ol>\n</div>","frontmatter":{"title":"Implementing simple polling with Javascript"}}},"pageContext":{"slug":"/posts/simple-polling-with-js/"}}}